{"version":3,"sources":["src/react-dom/render.js","src/react/Component.js","src/react/index.js","src/react-dom/index.js","src/index.js"],"names":["createElement","renderComponent","render","tag","attrs","children","component","base","renderer","componentWillUpdate","_render","componentDidUpdate","componentDidMount","parentNode","replaceChild","_component","setComponentProps","props","componentWillMount","componentWillReceiveProps","createComponent","inst","prototype","Component","constructor","setAttribute","dom","name","value","test","toLowerCase","style","cssText","removeAttribute","vnode","undefined","document","createTextNode","String","Object","keys","forEach","key","child","container","appendChild","state","assign","Welcome","Counter","num","onClick","bind","console","log","setState","React","ReactDOM","getElementById"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAEgBA,gBAAAA;QAIAC,kBAAAA;QA+GAC,SAAAA;;AArHhB;;;;;;AAEO,SAASF,aAAT,CAAuBG,GAAvB,EAA4BC,KAA5B,EAAgD;AAAA,oCAAVC,QAAU;AAAVA,YAAU;AAAA;;AACrD,SAAO,EAAEF,QAAF,EAAOC,YAAP,EAAcC,kBAAd,EAAP;AACD;;AAEM,SAASJ,eAAT,CAAyBK,SAAzB,EAAoC;AACzC,MAAIC,aAAJ;AACA,MAAMC,WAAWF,UAAUJ,MAAV,EAAjB;;AAEA;AACA,MAAII,UAAUC,IAAV,IAAkBD,UAAUG,mBAAhC,EAAqD;AACnDH,cAAUG,mBAAV;AACD;;AAEDF,SAAOG,QAAQF,QAAR,CAAP;;AAEA,MAAIF,UAAUC,IAAd,EAAoB;AAClB;AACA,QAAID,UAAUK,kBAAd,EAAkCL,UAAUK,kBAAV;AACnC,GAHD,MAGO,IAAIL,UAAUM,iBAAd,EAAiC;AACtC;AACAN,cAAUM,iBAAV;AACD;;AAED,MAAIN,UAAUC,IAAV,IAAkBD,UAAUC,IAAV,CAAeM,UAArC,EAAiD;AAC/CP,cAAUC,IAAV,CAAeM,UAAf,CAA0BC,YAA1B,CAAuCP,IAAvC,EAA6CD,UAAUC,IAAvD;AACD;;AAEDD,YAAUC,IAAV,GAAiBA,IAAjB;AACA;AACAA,OAAKQ,UAAL,GAAkBT,SAAlB;AACD;;AAED,SAASU,iBAAT,CAA2BV,SAA3B,EAAsCW,KAAtC,EAA4C;AAC1C,MAAG,CAACX,UAAUC,IAAd,EAAmB;AACjB;AACA,QAAGD,UAAUY,kBAAb,EAAiCZ,UAAUY,kBAAV;AAClC,GAHD,MAGO;AACL;AACAZ,cAAUa,yBAAV,CAAoCF,KAApC;AACD;;AAEDX,YAAUW,KAAV,GAAkBA,KAAlB;AACAhB,kBAAgBK,SAAhB;AACD;;AAED,SAASc,eAAT,CAAyBd,SAAzB,EAAoCW,KAApC,EAA0C;AACxC,MAAII,aAAJ;AACA,MAAGf,UAAUgB,SAAV,IAAuBhB,UAAUgB,SAAV,CAAoBpB,MAA9C,EAAqD;AACnDmB,WAAO,IAAIf,SAAJ,CAAcW,KAAd,CAAP;AACD,GAFD,MAEO;AACLI,WAAO,IAAIE,mBAAJ,CAAcN,KAAd,CAAP;AACAI,SAAKG,WAAL,GAAmBlB,SAAnB;AACAe,SAAKnB,MAAL,GAAc,YAAW;AACvB,aAAO,KAAKsB,WAAL,CAAiBP,KAAjB,CAAP;AACD,KAFD;AAGD;AACD,SAAOI,IAAP;AACD;;AAED,SAASI,YAAT,CAAsBC,GAAtB,EAA2BC,IAA3B,EAAiCC,KAAjC,EAAwC;AACtC,MAAGD,SAAS,WAAZ,EAAyBA,OAAO,OAAP;;AAEzB,MAAG,QAAQE,IAAR,CAAaF,IAAb,CAAH,EAAsB;AACpBA,WAAOA,KAAKG,WAAL,EAAP;AACAJ,QAAIC,IAAJ,IAAYC,SAAS,EAArB;AACD,GAHD,MAGO,IAAGD,SAAO,OAAV,EAAmB;AACxB,QAAG,CAACC,KAAD,IAAU,OAAOA,KAAP,KAAiB,QAA9B,EAAuC;AACrCF,UAAIK,KAAJ,CAAUC,OAAV,GAAoBJ,SAAO,EAA3B;AACD,KAFD,MAEO,IAAGA,SAAS,QAAOA,KAAP,yCAAOA,KAAP,OAAiB,QAA7B,EAAsC;AAC3C,WAAI,IAAID,KAAR,IAAgBC,KAAhB,EAAuB;AACrBF,YAAIK,KAAJ,CAAUJ,KAAV,IAAkBC,MAAMD,KAAN,CAAlB;AACD;AACF,KAJM,MAIA;AACL,UAAGA,QAAQD,GAAX,EAAe;AACbA,YAAIC,IAAJ,IAAYC,SAAO,EAAnB;AACD;AACD,UAAGA,KAAH,EAAS;AACPF,YAAID,YAAJ,CAAiBE,IAAjB,EAAuBC,KAAvB;AACD,OAFD,MAEO;AACLF,YAAIO,eAAJ,CAAoBN,IAApB,EAA0BC,KAA1B;AACD;AACF;AACF;AACF;;AAED,SAASlB,OAAT,CAAiBwB,KAAjB,EAAwB;;AAEtB,MAAGA,UAAQC,SAAR,IAAmBD,UAAQ,IAA3B,IAAiC,OAAOA,KAAP,KAAe,SAAnD,EAA8DA,QAAO,EAAP;;AAE9D,MAAG,OAAOA,KAAP,KAAiB,QAAjB,IAA6B,OAAOA,KAAP,KAAiB,QAAjD,EAA2D;AACzD,WAAOE,SAASC,cAAT,CAAwBC,OAAOJ,KAAP,CAAxB,CAAP;AACD;;AAED,MAAG,OAAOA,MAAM/B,GAAb,KAAqB,UAAxB,EAAoC;AAClC,QAAMG,YAAYc,gBAAgBc,MAAM/B,GAAtB,EAA2B+B,MAAM9B,KAAjC,CAAlB;AACAY,sBAAkBV,SAAlB,EAA6B4B,MAAM9B,KAAnC;AACA,WAAOE,UAAUC,IAAjB;AACD;;AAED,MAAMmB,MAAMU,SAASpC,aAAT,CAAuBkC,MAAM/B,GAA7B,CAAZ;;AAEA,MAAG+B,MAAM9B,KAAT,EAAgB;AACdmC,WAAOC,IAAP,CAAYN,MAAM9B,KAAlB,EAAyBqC,OAAzB,CAAiC,eAAO;AACtC,UAAMb,QAAQM,MAAM9B,KAAN,CAAYsC,GAAZ,CAAd;AACAjB,mBAAaC,GAAb,EAAkBgB,GAAlB,EAAuBd,KAAvB;AACD,KAHD;AAID;;AAEDM,QAAM7B,QAAN,CAAeoC,OAAf,CAAuB,iBAAS;AAC9BvC,WAAOyC,KAAP,EAAcjB,GAAd;AACD,GAFD;;AAIA,SAAOA,GAAP;AACD;;AAEM,SAASxB,MAAT,CAAgBgC,KAAhB,EAAuBU,SAAvB,EAAiC;AACtC,MAAMlB,MAAMhB,QAAQwB,KAAR,CAAZ;AACA,SAAOU,UAAUC,WAAV,CAAsBnB,GAAtB,CAAP;AACD;;;;;;;;;;ACxHD;;;;IAEqBH;AACnB,uBAAsB;AAAA,QAAVN,KAAU,uEAAJ,EAAI;;AAAA;;AACpB,SAAKA,KAAL,GAAaA,KAAb;AACA,SAAK6B,KAAL,GAAa,EAAb;AACD;;;;6BAEQA,OAAM;AACbP,aAAOQ,MAAP,CAAc,KAAKD,KAAnB,EAA0BA,KAA1B;AACA,mCAAgB,IAAhB;AACD;;;;;;kBATkBvB;;;;;;;;ACFrB;;;;AACA;;;;kBAEe;AACbA,gCADa;AAEbvB;AAFa;;;;;;;;ACHf;;kBAEe;AACbE;AADa;;;;;;ACDf;;;;AACA;;;;;;;;;;+eAFA;;;AAIA,SAAS8C,OAAT,CAAiB/B,KAAjB,EAAwB;AACtB,SAAO;AAAA;AAAA;AAAA;AAAYA,UAAMU;AAAlB,GAAP;AACD;;IAEKsB;;;AACJ,mBAAYhC,KAAZ,EAAmB;AAAA;;AAAA,kHACXA,KADW;;AAEjB,UAAK6B,KAAL,GAAa;AACXI,WAAK;AADM,KAAb;AAGA,UAAKC,OAAL,GAAe,MAAKA,OAAL,CAAaC,IAAb,OAAf;AALiB;AAMlB;;;;0CAEqB;AACpBC,cAAQC,GAAR,CAAY,QAAZ;AACD;;;yCAEmB;AAClBD,cAAQC,GAAR,CAAY,YAAZ;AACD;;;wCAEmB;AAClBD,cAAQC,GAAR,CAAY,WAAZ;AACD;;;8BAES;AACR,UAAMJ,MAAM,KAAKJ,KAAL,CAAWI,GAAX,GAAiB,CAA7B;AACA,WAAKK,QAAL,CAAc;AACZL;AADY,OAAd;AAGD;;;6BAEQ;AACP,aAAO;AAAA;AAAA;AACL;AAAA;AAAA;AAAA;AAAU,eAAKJ,KAAL,CAAWI;AAArB,SADK;AAEL;AAAA;AAAA,YAAQ,SAAS,KAAKC,OAAtB;AAAA;AAAA;AAFK,OAAP;AAID;;;;EAjCmBK,gBAAMjC;;AAoC5BkC,mBAASvD,MAAT,CAAgB;AAAA;AAAA;AACd,gCAAC,OAAD,IAAS,MAAK,SAAd,GADc;AAEd,gCAAC,OAAD,IAAS,MAAK,MAAd,GAFc;AAGd,gCAAC,OAAD,IAAS,MAAK,OAAd,GAHc;AAId,gCAAC,OAAD;AAJc,CAAhB,EAKQkC,SAASsB,cAAT,CAAwB,MAAxB,CALR","file":"src.56f3d125.map","sourceRoot":"..","sourcesContent":["import Component from '../react/Component';\n\nexport function createElement(tag, attrs, ...children) {\n  return { tag, attrs, children };\n}\n\nexport function renderComponent(component) {\n  let base;\n  const renderer = component.render();\n \n  //更新前生命周期\n  if (component.base && component.componentWillUpdate) {\n    component.componentWillUpdate();\n  }\n\n  base = _render(renderer);\n\n  if (component.base) {\n    //更新后生命周期\n    if (component.componentDidUpdate) component.componentDidUpdate();\n  } else if (component.componentDidMount) {\n    //挂载后生命周期\n    component.componentDidMount();\n  }\n\n  if (component.base && component.base.parentNode) {\n    component.base.parentNode.replaceChild(base, component.base);\n  }\n  \n  component.base = base;\n  //为何记录base._component\n  base._component = component; \n}\n\nfunction setComponentProps(component, props){\n  if(!component.base){\n    //挂载前生命周期\n    if(component.componentWillMount) component.componentWillMount();\n  } else {\n    //props更新前生命周期\n    component.componentWillReceiveProps(props);\n  }\n\n  component.props = props;\n  renderComponent(component);\n}\n\nfunction createComponent(component, props){\n  let inst;\n  if(component.prototype && component.prototype.render){\n    inst = new component(props);\n  } else {\n    inst = new Component(props);\n    inst.constructor = component;\n    inst.render = function() {\n      return this.constructor(props);\n    }\n  }\n  return inst;\n}\n\nfunction setAttribute(dom, name, value) {\n  if(name === 'className') name = 'class';\n\n  if(/on\\w+/.test(name)){\n    name = name.toLowerCase();\n    dom[name] = value || '';\n  } else if(name==='style') {\n    if(!value || typeof value === 'string'){\n      dom.style.cssText = value||'';\n    } else if(value && typeof value === 'object'){\n      for(let name in value) {\n        dom.style[name] = value[name];\n      }\n    } else {\n      if(name in dom){\n        dom[name] = value||'';\n      }\n      if(value){\n        dom.setAttribute(name, value);\n      } else {\n        dom.removeAttribute(name, value);\n      }\n    }\n  }\n}\n\nfunction _render(vnode) {\n  \n  if(vnode===undefined||vnode===null||typeof vnode==='boolean') vnode ='';\n\n  if(typeof vnode === 'number' || typeof vnode === 'string') {\n    return document.createTextNode(String(vnode));\n  }\n\n  if(typeof vnode.tag === 'function') {\n    const component = createComponent(vnode.tag, vnode.attrs);\n    setComponentProps(component, vnode.attrs);\n    return component.base;\n  }\n\n  const dom = document.createElement(vnode.tag);\n\n  if(vnode.attrs) {\n    Object.keys(vnode.attrs).forEach(key => {\n      const value = vnode.attrs[key];\n      setAttribute(dom, key, value);\n    });\n  }\n\n  vnode.children.forEach(child => {\n    render(child, dom);\n  });\n  \n  return dom;\n}\n\nexport function render(vnode, container){\n  const dom = _render(vnode);\n  return container.appendChild(dom);\n}\n","import { renderComponent } from '../react-dom/render';\n\nexport default class Component {\n  constructor(props={}) {\n    this.props = props;\n    this.state = {};\n  }\n\n  setState(state){\n    Object.assign(this.state, state);\n    renderComponent(this);\n  }\n}\n","import Component from './Component.js';\nimport { createElement } from '../react-dom/render.js';\n\nexport default {\n  Component,\n  createElement\n}\n","import { render } from './render';\n\nexport default {\n  render\n}\n\n","//当前进展：组件化\nimport React from './react';\nimport ReactDOM from './react-dom';\n\nfunction Welcome(props) {\n  return <h1>Hello, {props.name}</h1>;\n}\n\nclass Counter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      num: 1\n    };\n    this.onClick = this.onClick.bind(this);\n  }\n\n  componentWillUpdate() {\n    console.log('update');\n  }\n\n  componentWillMount(){\n    console.log('will mount');\n  }\n\n  componentDidMount() {\n    console.log('did mount');\n  }\n\n  onClick() {\n    const num = this.state.num + 1;\n    this.setState({\n      num \n    });\n  }\n\n  render() {\n    return <div>\n      <h1>num: {this.state.num}</h1>\n      <button onClick={this.onClick}>add</button>\n    </div>;\n  }\n}\n\nReactDOM.render(<div>\n  <Welcome name=\"junlong\" />\n  <Welcome name=\"sara\" />\n  <Welcome name=\"laurd\" />\n  <Counter />\n</div>, document.getElementById('root'));\n"]}